{
  "id": "LEARN-PROF-001",
  "title": "Learner Profile Aggregation",
  "version": "1.0",
  "status": "Draft",
  "date": "2026-02-04",
  "domain": "learning",
  "specType": "SYSTEM",
  "outputType": "AGGREGATE",

  "metadata": {
    "observation": {
      "signalParameters": [
        "question_asking_rate",
        "response_length_preference",
        "engagement_with_examples",
        "pace_indicators"
      ],
      "aggregationMethod": "weighted_average",
      "minimumConfidence": 0.6
    }
  },

  "story": {
    "asA": "personalization system",
    "iWant": "to aggregate learning behavior observations into a stable learner profile",
    "soThat": "the tutor can consistently adapt to learner preferences"
  },

  "context": {
    "applies": "After MEASURE specs have scored learning behaviors",
    "dependsOn": ["LEARN-STYLE-001"],
    "assumptions": [
      "Profile stabilizes after 3+ observations",
      "Recent observations weighted more heavily",
      "Explicit preferences override inferred ones"
    ]
  },

  "parameters": [
    {
      "id": "aggregate_profile",
      "name": "Aggregate Learner Profile",
      "description": "Combines recent observations into stable profile attributes",
      "section": "aggregation",
      "config": {
        "aggregationRules": [
          {
            "sourceParameter": "question_asking_rate",
            "targetProfileKey": "question_frequency",
            "method": "threshold_mapping",
            "thresholds": [
              {"min": 0.7, "value": "frequent", "confidence": 0.8},
              {"min": 0.3, "max": 0.7, "value": "occasional", "confidence": 0.7},
              {"max": 0.3, "value": "rare", "confidence": 0.8}
            ]
          },
          {
            "sourceParameter": "question_asking_rate",
            "targetProfileKey": "interaction_style",
            "method": "threshold_mapping",
            "thresholds": [
              {"min": 0.7, "value": "conversational"},
              {"min": 0.3, "max": 0.7, "value": "guided"},
              {"max": 0.3, "value": "direct"}
            ]
          },
          {
            "sourceParameter": "response_length_preference",
            "targetProfileKey": "feedback_style",
            "method": "threshold_mapping",
            "thresholds": [
              {"min": 0.7, "value": "detailed"},
              {"max": 0.3, "value": "summarized"}
            ]
          },
          {
            "sourceParameter": "engagement_with_examples",
            "targetProfileKey": "learning_style",
            "method": "threshold_mapping",
            "thresholds": [
              {"min": 0.7, "value": "visual"},
              {"max": 0.3, "value": "reading"}
            ]
          },
          {
            "sourceParameter": "pace_indicators",
            "targetProfileKey": "pace_preference",
            "method": "threshold_mapping",
            "thresholds": [
              {"min": 0.7, "value": "fast"},
              {"min": 0.3, "max": 0.7, "value": "moderate"},
              {"max": 0.3, "value": "slow"}
            ]
          }
        ],
        "windowSize": 5,
        "recencyWeight": 0.7,
        "minimumObservations": 3
      }
    }
  ],

  "triggers": [
    {
      "name": "Update Learner Profile",
      "given": "New learning behavior scores are available",
      "when": "Aggregation phase runs",
      "then": "Update CallerAttribute with aggregated profile using contract-defined keys",
      "actions": [
        {
          "description": "Aggregate observations and write to learner_profile:* keys",
          "parameterId": "aggregate_profile",
          "weight": 1.0
        }
      ]
    }
  ]
}
